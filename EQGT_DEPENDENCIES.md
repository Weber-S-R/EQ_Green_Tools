# EQ Green Tools - Dependencies

Complete guide to dependencies and requirements for EQ Green Tools (EQGT).

---

## ‚úÖ Required Dependencies

### 1. Windows PowerShell
**Version:** PowerShell 5.1+ (Windows 10/11) or PowerShell 7+ (Cross-platform)

**Check Version:**
```powershell
$PSVersionTable.PSVersion
```

**Installation:**
- **PowerShell 5.1**: Included with Windows 10/11
- **PowerShell 7+**: Download from https://aka.ms/powershell

**No additional modules required!** All functionality uses built-in PowerShell cmdlets.

---

### 2. Internet Connection
**Required for:**
- Fetching price data from PigParse.org API
- Initial cache population
- Cache refresh (every 7 days)

**Bandwidth:** Minimal - single API call loads all prices (~3MB)

---

### 3. EverQuest Project 1999 Client
**Required for:**
- Generating inventory export files

**How to Generate Inventory Files:**
1. Log into your character in Project 1999
2. Type in chat: `/output inventory`
3. File is created at: `C:\EQEmu\CharacterName-Inventory.txt`

**Note:** You need to run `/output inventory` for each character you want to analyze.

---

## üìã Optional Dependencies

### Microsoft Edge (for fallback scraping)
**Purpose:** Used as fallback if API is unavailable

**Location:** Usually installed at:
- `C:\Program Files\Microsoft\Edge\Application\msedge.exe`
- `C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe`

**Note:** Only used if PigParse API fails. Not required for normal operation.

---

## üîç Built-in PowerShell Modules Used

All required functionality is built into PowerShell. No additional modules need to be installed.

**Modules Used:**
- `Microsoft.PowerShell.Utility` - JSON parsing, CSV handling
- `Microsoft.PowerShell.Management` - File operations
- `Microsoft.PowerShell.Core` - Core cmdlets

**Cmdlets Used:**
- `ConvertFrom-Json` - Parse JSON data
- `ConvertTo-Json` - Create JSON files
- `ConvertFrom-Csv` - Parse inventory files
- `Export-Csv` - Create CSV reports
- `Invoke-WebRequest` - API calls
- `Join-Path` - Path manipulation
- `Test-Path` - File existence checks
- `Get-Content` - Read files
- `Set-Content` - Write files

---

## üåê External Services

### PigParse.org API
**Endpoint:** `https://api.pigparse.org/api/item/getall/Green`

**Purpose:** Provides bulk item pricing data for Project 1999 Green server

**Data Format:** JSON array with ~9,000 items

**Caching:** 
- Data cached locally for 7 days
- Cache file: `EQGT_cache_pigparse_green.json`
- Automatic refresh after cache expiration

**Rate Limiting:** 
- Single API call loads all prices
- No rate limits with 7-day caching
- Respectful usage built-in

**No API Key Required:** Public API endpoint

---

## üìÅ File Dependencies

### Input Files (Required)
**Location:** `C:\EQEmu\` (default) or custom path

**Format:** Tab-separated values (TSV)

**Structure:**
```
Location        Name                    ID      Count   Slots
General1-Slot1  Black Pearl            12345   1       5
General1-Slot2  Rune of Al'Kabor        67890   1       5
```

**Generated By:** EverQuest Project 1999 client (`/output inventory`)

---

### Configuration Files (Auto-Generated)
**EQGT_pigparse_config.json**
- Created automatically if missing
- Contains API configuration
- Can be edited manually if needed

**EQGT_cache_pigparse_green.json**
- Created on first API call
- Contains cached price data
- ~3MB file size
- Valid for 7 days

---

## üö´ What You DON'T Need

### ‚ùå No Python Required
All scripts are pure PowerShell.

### ‚ùå No Node.js Required
No JavaScript/Node dependencies.

### ‚ùå No Additional PowerShell Modules
No need to install modules from PowerShell Gallery.

### ‚ùå No Database Required
All data stored in JSON files.

### ‚ùå No Web Server Required
Runs locally on your machine.

### ‚ùå No API Keys Required
PigParse API is public.

### ‚ùå No Compilation Required
Pure PowerShell scripts - run directly.

---

## üîß System Requirements

### Operating System
- **Windows 10** (recommended)
- **Windows 11** (recommended)
- **Windows Server 2016+** (should work)
- **PowerShell Core on Linux/Mac** (may work, untested)

### Disk Space
- **Scripts:** ~100 KB
- **Cache file:** ~3 MB
- **Output files:** Varies (typically < 1 MB per character)

**Total:** < 5 MB

### Memory
- **Minimum:** 512 MB RAM
- **Recommended:** 1 GB+ RAM
- **Cache loading:** ~50-100 MB temporary

### Network
- **Initial setup:** ~3 MB download (cache population)
- **Updates:** ~3 MB every 7 days
- **Per-run:** Minimal (uses cache)

---

## ‚úÖ Quick Dependency Check

Run this in PowerShell to verify all dependencies:

```powershell
# Check PowerShell version
Write-Host "PowerShell Version: $($PSVersionTable.PSVersion)" -ForegroundColor Cyan

# Check required cmdlets
$required = @('ConvertFrom-Json', 'ConvertTo-Json', 'ConvertFrom-Csv', 'Export-Csv', 'Invoke-WebRequest')
foreach ($cmdlet in $required) {
    if (Get-Command $cmdlet -ErrorAction SilentlyContinue) {
        Write-Host "‚úì $cmdlet available" -ForegroundColor Green
    } else {
        Write-Host "‚úó $cmdlet missing" -ForegroundColor Red
    }
}

# Check internet connectivity
try {
    $response = Invoke-WebRequest -Uri "https://api.pigparse.org" -UseBasicParsing -TimeoutSec 5
    Write-Host "‚úì Internet connection OK" -ForegroundColor Green
} catch {
    Write-Host "‚úó Internet connection failed" -ForegroundColor Red
}

# Check EQEmu directory
if (Test-Path "C:\EQEmu") {
    Write-Host "‚úì EQEmu directory found" -ForegroundColor Green
    $invFiles = Get-ChildItem "C:\EQEmu\*-Inventory.txt" -ErrorAction SilentlyContinue
    Write-Host "  Found $($invFiles.Count) inventory file(s)" -ForegroundColor Cyan
} else {
    Write-Host "‚ö† EQEmu directory not found (use -EQEmuPath parameter)" -ForegroundColor Yellow
}
```

---

## üêõ Troubleshooting Dependencies

### PowerShell Version Too Old
**Error:** `ConvertFrom-Json : The term 'ConvertFrom-Json' is not recognized`

**Solution:** Upgrade to PowerShell 5.1+ or PowerShell 7+

### Execution Policy Blocked
**Error:** `cannot be loaded because running scripts is disabled on this system`

**Solution:**
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### Internet Connection Failed
**Error:** `API request failed` or `No such host is known`

**Solution:**
- Check internet connection
- Verify firewall isn't blocking PowerShell
- Try again in a few minutes (API may be temporarily down)

### Inventory Files Not Found
**Error:** `Input file not found`

**Solution:**
- Run `/output inventory` in-game for each character
- Verify files are in `C:\EQEmu\` (or use `-EQEmuPath` parameter)
- Check file naming: `CharacterName-Inventory.txt` (case-sensitive)

---

## üìö Additional Resources

### PowerShell Documentation
- https://docs.microsoft.com/powershell/

### PigParse.org
- https://www.pigparse.org/
- API endpoint: https://api.pigparse.org

### Project 1999
- https://www.project1999.com/
- Forums: https://www.project1999.com/forums/

---

## ‚úÖ Summary

**Minimum Setup:**
1. Windows 10/11 with PowerShell 5.1+
2. Internet connection
3. EverQuest Project 1999 client (to generate inventory files)

**That's it!** No additional installations required.

All dependencies are either:
- Built into Windows/PowerShell
- Public web services (no authentication)
- Generated by you (inventory files)

---

**Last Updated:** 2025-11-17

